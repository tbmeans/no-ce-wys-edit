<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Post Writer</title>
  <style>
    body {
      background-color: #333;
    }
    #main-container {
      background-color: #aaa;
      margin: 1in 1in;
      min-height: 40rem;
    }
    #write-space {
      white-space: pre;
      padding: 2rem 2rem;
    }
    @keyframes blinky {
      from {
        color: black;
      }
      to {
        color: gray;
      }
    }
    #cursor {
      animation: 1s infinite blinky;
    }
  </style>
</head>
<body>
  <div id="main-container">
    <p id="write-space">abc<span id="cursor">|</span>123</p>
  </div>
<script>
const space = document.getElementById("write-space");
const cursor = document.getElementById("cursor");
const getText = () => {
  const nodes = Array.from(space.childNodes);
  return nodes.length === 3 && [ nodes[0], nodes[2] ] ||
      nodes[0].nodeValue && [ nodes[0], null ] || [ null, nodes[1] ];
};
const cleanText = () => { 
  // hit return for new line then erase that new line then tab leads to empty
  // post-cursor text. haven't reasoned out how charedit allows that yet so 
  // made this cleaning function
  const [ precurs, postcur ] = getText();
  if (postcur.nodeValue.length === 0) {
    space.removeChild(postcur);
  }
  if (precurs.nodeValue.length === 0) {
    space.removeChild(precurs);
  }
};
const charEdit = (value) => {
  const [ precurs, postcur ] = getText();
  // cleanText(); nope this then causes Delete to not work
  if (value === -1 && precurs) {
    precurs.nodeValue = precurs.nodeValue.slice(0, -1);
  } else if (value === +1 && postcur) {
    postcur.nodeValue = postcur.nodeValue.slice(1);
  } else if (!precurs) {
    space.insertBefore(document.createTextNode(value), cursor);
  } else {
    precurs.nodeValue = precurs.nodeValue + value;
  }
};
const moveCurs = (direction) => {};
document.body.addEventListener("keydown", (event) => {
  switch(event.key) {
    case "Backspace":
      charEdit(-1);
      break;
    case "Delete": 
      charEdit(+1);
      break;
    case "Enter":
      charEdit('\n');
      break;
    case "Tab":
      charEdit('     ');
      break;
    case "Shift":
    case "Control":
    case "CapsLock":
    case "NumLock":
      break;
    default:
      charEdit(event.key);
  }
});
</script>
</body>
</html>
